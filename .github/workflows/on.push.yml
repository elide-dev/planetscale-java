name: "CI"

on:
  ## Event: PR
  push:
    paths:
      ## Trigger: Global changes/release
      - ".version"
      - ".release"
      - "gradle.properties"
      - "*.kts"
      - "**/*.kts"
      - "**/*.kt"
      - "**/*.java"
      - "**/*.properties"
      - "gradle/**"
      - ".github/workflows/*.yml"

permissions:
  contents: read

jobs:
  ## Build Library
  build-library:
    name: "CI: Build"
    uses: ./.github/workflows/module.build.yml
    secrets: inherit
    permissions:
      contents: write
      id-token: write
      checks: write
      pull-requests: read
    with:
      graph: generate-and-submit

  ## Checks: CodeQL
  checks-codeql:
    uses: ./.github/workflows/module.codeql.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      security-events: write
    with: {}

  ## Checks CodeQL
  checks-detekt:
    uses: ./.github/workflows/module.detekt.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      security-events: write
    with: {}
